<?xml version="1.0" encoding="utf-8"?>
<!--
	 <p><b>auth：</b>HUBO</p>
	 <p><b>create-time：</b>2012-6-6</p>
	 <p><b>mail：</b>hubo.0508ⓐgmail.com	</p>
-->
<s:Group xmlns:fx="http://ns.adobe.com/mxml/2009"
		 xmlns:s="library://ns.adobe.com/flex/spark"
		 xmlns:mx="library://ns.adobe.com/flex/mx"
		 xmlns:child="com.hubo.workflow.ui.child.*"
		 creationComplete="init()"
		 width="100%"
		 height="100%">
	
	<fx:Script>
		<![CDATA[
			import com.hubo.workflow.core.ElementLine;
			import com.hubo.workflow.core.ElementNode;
			import com.hubo.workflow.event.CreateElementNodeEvent;
			import com.hubo.workflow.util.Global;
			
			import mx.core.IVisualElement;
			import mx.core.UIComponent;
			
			/**
			 * 初始事件监听
			 */
			private function initEventListener():void
			{
				this.addEventListener(MouseEvent.MOUSE_DOWN, drawLineHandler,false,0,true);  
				this.addEventListener(MouseEvent.MOUSE_UP,  drawLineHandler,false,0,true);  
				this.addEventListener(MouseEvent.MOUSE_MOVE,  drawLineHandler,false,0,true);  
			}
			
			/**
			 * 画线
			 */
			protected function drawLineHandler(event:MouseEvent):void
			{
				switch(event.type)
				{
					case MouseEvent.MOUSE_DOWN :
						break;
					
					case MouseEvent.MOUSE_UP :
						break;
					
					case MouseEvent.MOUSE_MOVE :
						break;
					
					default :
						break;
				}
			}
			
			private function init():void 
			{
				var node1:ElementNode=new ElementNode(new Point(300, 300), "开始", Global.START);
				var node2:ElementNode=new ElementNode(new Point(500, 400), "审批", Global.APPROVAL);
				var line:ElementLine=new ElementLine();
				line.setStartPoint(new Point(node1.getCenterX(), node1.getCenterY()));
				line.setEndPoint(new Point(node2.getCenterX(), node2.getCenterY()));
				line.setTip("哈哈哈哈");
				line.drawLine();
				node1.addAssociatedLines(line, true);
				node2.addAssociatedLines(line, false);
				workflowGroup.addElement(node1);
				workflowGroup.addElement(node2);
				workflowGroup.addElement(line);
				
			}
			
			/**
			 * 调用底层API画背景网格
			 */
			override protected function updateDisplayList(w:Number, h:Number):void
			{
				super.updateDisplayList(w,h);
				Global.drawBackgroundGrid(grid,w,h);
			}
			
			/**
			 * 点击级件（IconTools）工具栏时，创建元素节点
			 */
			protected function createElementNodeHandler(event:CreateElementNodeEvent):void
			{
				workflowGroup.addElement(event.node);
			}

		]]>
	</fx:Script>
	
	<mx:UIComponent id="grid"/>
	
	<s:Group id="workflowGroup" width="100%" height="100%"/>
	
	<s:BitmapImage source="{Global.LOG}" horizontalCenter="0" top="40"/>
	
	<child:IconTools createElementNode="createElementNodeHandler(event)"/>
	
	<!--<child:Config/>-->

</s:Group>
